<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Latest Project</title>
  <%- include('./partials/csslinks') %>
</head>

<body>
  <%- include('./partials/header') %>

  <section class="dashboard-main-section">
    <div class="container">
      <div class="dashboard-main-setting profile-info mx-auto">
        <div class="profile-history">
          <div class="profile-person-history">
            <img src="/sites/e4d4/assets/img/user-icon.webp" alt="">
            <div class="px-3">
              <h6><%= user.fullName %><span> ( Edit Portfolio )</span></h6>
              <span>Enter Subheading</span>
            </div>
          </div>
          <div class="d-flex align-items-center flex-wrap justify-content-center">
            <button type="button" class="dash-btn"> <i class="bi bi-check2-all text-white px-1"></i> Done</button>
            <button type="button" class="logout-btn ms-2"><i class="bi bi-bell"></i></button>
          </div>
        </div>
        <div class="row justify-content-between my-4">
          <div class="col-lg-4 col-12">
            <div class="history-btn-design">
              <button type="button" class="dash-btn">
                Home</button>
              <button type="button" class="dash-btn">
                Show History</button>
            </div>
          </div>
          <div class="col-lg-5 col-12">
            <div class="history-input-design">
              <input type="text" class="" placeholder="Search Talent..">
              <i class="bi bi-search"></i>
            </div>
          </div>
        </div>
        <h5 class="fw-bold text-center fw-head">Profile / Portfolio</h5>
        <div class="profile-banner">
          <div class="banner-cover">
            <img class="img-fluid" src="/sites/e4d4/assets/img/cover.png" alt="">
          </div>
          <div class="banner-info">
            <div class="profile-person-history large-img">
              <img src="/sites/e4d4/assets/img/user-icon.webp" alt="">
              <div class="px-3 pb-2">
                <h5><%= user.fullName %><span> ( UI/UX Designer )</span></h5>
                <span><span data-name="headline" class="edit-it" contenteditable="">Lorem IpsumÂ is simply dummy text of the printing and typesetting industry. </span><button class="edit-btn" data-target='[data-name="headline"]'><i class="bi bi-pencil-square"></i></button></span>
              </div>
            </div>
            <span class="profile-badge"><%= user.experience %>+ Years Of Experience</span>
          </div>
        </div>
        <ul class="other-info">
          <li>@edwardjj53</li>
          <li>Sydney, Australia</li>
          <li>Member Since Jan 2024</li>
          <li>(15) Recommendations</li>
        </ul>
        <div class="additional-info">
          <div class="row g-0">
            <div class="col-lg-8 col-12 panel">
              <div class="info-item-l h-100">
                <h6 class="fw-bold">About <button class="edit-btn"><i class="bi bi-pencil-square"></i></button></h6>
                <% if(user.about){ %>
                <p><%= user.about %></p>
                <% } else { %>
                <p class="text-muted">No About...</p>
                <% } %>
                <% if(user.profileVideo){ %>
                <div class="profile-video">
                  <a href="">
                    <i class="bi bi-play-fill"></i>
                  </a>
                  <img src="/sites/e4d4/assets/img/video-poster.png">
                </div>
                <% } else { %>
                <label class="empty-box" for="profileVideo">
                  <input type="file" name="profileVideo" id="profileVideo" accept="video/*">
                  <img src="/sites/e4d4/assets/img/video-upload.png" alt="">
                  <h5>Upload Video to show Here</h5>
                </label>
                <% } %>
              </div>
            </div>
            <div class="col-lg-4 col-12 panel">
              <div class="info-item-r h-100">
                <h6 class="fw-bold">Connect With Me <button class="edit-btn"><i class="bi bi-pencil-square"></i></button></h6>
                <ul class="contact-links">
                  <% if(user.primaryEmail?.email){ %>
                  <li>
                    <span>Email Address</span>
                    <a href="mailto:<%= user.primaryEmail?.email %>"><%= user.primaryEmail?.email %></a>
                  </li>
                  <% } %>
                  <% if(user.phone){ %>
                  <li>
                    <span>Phone #</span>
                    <a href="tel:<%= user.phone %>"><%= user.phone %></a>
                  </li>
                  <% } %>
                  <% if(user.phone){ %>
                  <li>
                    <span>LinkedIn</span>
                    <a href="<%= user.linkedin %>"><%= user.linkedin %></a>
                  </li>
                  <% } %>
                </ul>
                <div class="position-details">
                  <span>UI/UX</span>
                  <span>Branding</span>
                  <span>Logo</span>
                </div>
                <img class="img-fluid mt-3" src="/sites/e4d4/assets/img/social.png" alt="">
              </div>
            </div>
          </div>
        </div>
        <div class="portfolio-showcase">
          <h6 class="fw-bold">Projects Showcase <button class="edit-btn"><i class="bi bi-pencil-square"></i></button></h6>
          <% if(user.projects?.length > 0) { %>
          <div class="row g-4 project-listing">
            <div class="col-lg-4 col-12">
              <div class="project-item">
                <h6>UI/UX Design</h6>
                <img class="img-fluid" src="/sites/e4d4/assets/img/demo-projects/1.png" alt="">
              </div>
            </div>
            <div class="col-lg-4 col-12">
              <div class="project-item">
                <h6>UI/UX Design</h6>
                <img class="img-fluid" src="/sites/e4d4/assets/img/demo-projects/1.png" alt="">
              </div>
            </div>
            <div class="col-lg-4 col-12">
              <div class="project-item">
                <h6>UI/UX Design</h6>
                <img class="img-fluid" src="/sites/e4d4/assets/img/demo-projects/1.png" alt="">
              </div>
            </div>
          </div>
          <% } else { %>
          <label class="empty-box" for="projects">
            <input type="file" name="projects" id="projects" multiple>
            <img src="/sites/e4d4/assets/img/empty.png" alt="">
            <h5>Upload Some Projects to show Here</h5>
          </label>
          <% } %>
          <h6 class="craft-experience">Crafting Excellence in Every Task</h6>
          <hr>
          <div class="follow-more">
            <h6>Follow To Know More About Me!</h6>
            <ul>
              <li>
                <a href="javascript:;">
                  <img src="/sites/e4d4/assets/img/social-icons/fb.png" alt="">
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <img src="/sites/e4d4/assets/img/social-icons/ins.png" alt="">
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <img src="/sites/e4d4/assets/img/social-icons/x.png" alt="">
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <img src="/sites/e4d4/assets/img/social-icons/link.png" alt="">
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <img src="/sites/e4d4/assets/img/social-icons/be.png" alt="">
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <%- include('./partials/query') %>
  <%- include('./partials/footer') %>
  <%- include('./partials/scriptlinks') %>
  <script>
    $('.edit-it').keyup(function() {
      if ($(this).html() == '') {
        $(this).addClass('no-txt')
      } else {
        $(this).removeClass('no-txt')
      }
    })
    $(".edit-btn").click(function() {
      $($(this).data('target'))[0].focus()
    })
    $("#profileVideo").change(async function(e) {
      const videoFormData = new FormData();
      const videoFile = e.target.files[0];
      videoFormData.append('profileVideo', videoFile);
      videoFormData.append('user', '<%= user.id %>');
      //   const videoRes = await fetch('/sites/e4d4/api/user/modify/profileVideo', {
      //       method: "POST",
      //       body: videoFormData
      //     });
      $('#loader').css('display', 'flex')
      $.ajax({
        url: '/sites/e4d4/api/user/modify/profileVideo',
        type: 'POST',
        data: videoFormData,
        processData: false, // Important
        contentType: false, // Important
        success: function(data) {
          $('#loader').hide()
          location.href = '/sites/e4d4/profile/<%= user.id %>'
        },
        error: function(err) {
          $('#loader').hide()
          console.error(err);
          alert(err)
        }
      });
    })
    $("#projects").change(function(e) {
      const projectFiles = e.target.files
      projectFormData.append('user','<%= user.id %>')
      const projectFormData = new FormData();
      for (let i = 0; i < projectFiles.length; i++) {
        projectFormData.append('projects', projectFiles[i]);
      }
      $('#loader').css('display','flex')
      $.ajax({
        url: '/sites/e4d4/api/user/modify/projects',
        type: 'POST',
        data: projectFormData,
        processData: false, // Important
        contentType: false, // Important
        success: function(data) {
          $('#loader').hide()
          location.href = '/sites/e4d4/profile/<%= user.id %>'
        },
        error: function(err) {
          $('#loader').hide()
          console.error(err);
          alert(err)
        }
      });
    })
  </script>
</body>

</html>